<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Replicator by mysql-time-machine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Replicator</h1>
      <h2 class="project-tagline">MySQL to HBase replicator. Mirrors MySQL tables in HBase, keeping the data changes history.</h2>
      <a href="https://github.com/mysql-time-machine/replicator" class="btn">View on GitHub</a>
      <a href="https://github.com/mysql-time-machine/replicator/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mysql-time-machine/replicator/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="replicator" class="anchor" href="#replicator" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Replicator</h2>

<p>Replicates data changes from MySQL binlog to HBase or Kafka. In case of HBase, preserves the previous data versions. HBase storage is intended for auditing purposes of historical data. In addition, special daily-changes tables can be maintained in HBase, which are convenient for fast and cheap imports from HBase to Hive. Replication to Kafka is intended for easy real-time access to a stream of data changes.</p>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h3>

<h4>
<a id="replicate-initial-binlog-snapshot-to-hbase" class="anchor" href="#replicate-initial-binlog-snapshot-to-hbase" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Replicate initial binlog snapshot to HBase</h4>

<pre><code>java -jar hbrepl-0.13.2.jar \
    --hbase-namespace $hbase-namespace \
    --applier hbase --schema $schema \
    --binlog-filename $first-binlog-filename \
    --config-path $config-path \
    --initial-snapshot
</code></pre>

<h4>
<a id="replication-to-hbase-after-initial-snapshot" class="anchor" href="#replication-to-hbase-after-initial-snapshot" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Replication to HBase after initial snapshot</h4>

<pre><code>java -jar hbrepl-0.13.2.jar \
    --hbase-namespace $hbase-namespace \
    --applier hbase \
    --schema $schema \
    --binlog-filename $binlog-filename \
    --config-path $config-path  \
    [--delta]
</code></pre>

<h4>
<a id="replication-to-kafka" class="anchor" href="#replication-to-kafka" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Replication to Kafka</h4>

<pre><code>java -jar hbrepl-0.13.2.jar \
    --applier kafka \
    --schema $schema \
    --binlog-filename $binlog-filename \
    --config-path $config-path
</code></pre>

<h4>
<a id="replicate-range-of-binlog-files-and-output-db-events-as-json-to-stdout" class="anchor" href="#replicate-range-of-binlog-files-and-output-db-events-as-json-to-stdout" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Replicate range of binlog files and output db events as JSON to STDOUT</h4>

<pre><code>java -jar hbrepl-0.13.2.jar \
    --applier STDOUT \
    --schema $schema \
    --binlog-filename $binlog-filename \
    --last-binlog-filename $last-binlog-filename-to-process \
    --config-path $config-path
</code></pre>

<h4>
<a id="configuration-file-structure" class="anchor" href="#configuration-file-structure" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration file structure</h4>

<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">replication_schema:</span>
    <span class="pl-ent">name:</span>      <span class="pl-s"><span class="pl-pds">'</span>replicated_schema_name<span class="pl-pds">'</span></span>
    <span class="pl-ent">username:</span>  <span class="pl-s"><span class="pl-pds">'</span>user<span class="pl-pds">'</span></span>
    <span class="pl-ent">password:</span>  <span class="pl-s"><span class="pl-pds">'</span>pass<span class="pl-pds">'</span></span>
    <span class="pl-ent">host_pool:</span> <span class="pl-s">['localhost']</span>
<span class="pl-ent">metadata_store:</span>
    <span class="pl-ent">username:</span> <span class="pl-s"><span class="pl-pds">'</span>user<span class="pl-pds">'</span></span>
    <span class="pl-ent">password:</span> <span class="pl-s"><span class="pl-pds">'</span>pass<span class="pl-pds">'</span></span>
    <span class="pl-ent">host:</span>     <span class="pl-s"><span class="pl-pds">'</span>active_schema_host<span class="pl-pds">'</span></span>
    <span class="pl-ent">database:</span> <span class="pl-s"><span class="pl-pds">'</span>active_schema_database<span class="pl-pds">'</span></span>
<span class="pl-s">    </span><span class="pl-c"># The following are options for storing replicator metadata, only one should be used (zookeeper or file)</span>
    <span class="pl-ent">zookeeper:</span>
        <span class="pl-ent">quorum:</span> <span class="pl-s">['zk-host1', 'zk-host2']</span>
        <span class="pl-ent">path:</span> <span class="pl-s"><span class="pl-pds">'</span>/path/in/zookeeper<span class="pl-pds">'</span></span>
    <span class="pl-ent">file:</span>
        <span class="pl-ent">path:</span> <span class="pl-s"><span class="pl-pds">'</span>/path/on/disk<span class="pl-pds">'</span></span>
<span class="pl-ent">hbase:</span>
    <span class="pl-ent">namespace:</span> <span class="pl-s"><span class="pl-pds">'</span>schema_namespace<span class="pl-pds">'</span></span>
    <span class="pl-ent">zookeeper_quorum:</span>  <span class="pl-s">['hbase-zk1-host', 'hbase-zkN-host']</span>
    <span class="pl-ent">hive_imports:</span>
        <span class="pl-ent">tables:</span> <span class="pl-s">['sometable']</span>
<span class="pl-ent">mysql_failover:</span>
    <span class="pl-ent">pgtid:</span>
        <span class="pl-ent">p_gtid_pattern:</span> <span class="pl-s">$regex_pattern_to_extract_pgtid</span>
        <span class="pl-ent">p_gtid_prefix:</span> <span class="pl-s">$prefix_to_add_to_pgtid_query_used_in_orchestrator_url</span>
    <span class="pl-ent">orchestrator:</span>
        <span class="pl-ent">username:</span> <span class="pl-s">orchestrator-user-name</span>
        <span class="pl-ent">password:</span> <span class="pl-s">orchestrator-password</span>
        <span class="pl-ent">url:</span>      <span class="pl-s">http://orchestrator-host/api</span>
<span class="pl-ent">metrics:</span>
    <span class="pl-ent">frequency:</span> <span class="pl-s">10 seconds</span>
    <span class="pl-ent">reporters:</span>
      <span class="pl-ent">graphite:</span>
        <span class="pl-ent">namespace:</span> <span class="pl-s"><span class="pl-pds">'</span>graphite.namespace.prefix<span class="pl-pds">'</span></span>
        <span class="pl-ent">url:</span> <span class="pl-s"><span class="pl-pds">'</span>graphite_host[:&lt;graphite_port (default is 3002)&gt;]<span class="pl-pds">'</span></span>
<span class="pl-c"># Optionally you can specify a console reporter for ease of testing</span>
<span class="pl-c">#      console:</span>
<span class="pl-c">#        timeZone: UTC</span>
<span class="pl-c">#        output: stdout</span></pre></div>

<h3>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LICENSE</h3>

<p>Copyright 2016 Bosko Devetak</p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at</p>

<pre><code>   http://www.apache.org/licenses/LICENSE-2.0
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mysql-time-machine/replicator">Replicator</a> is maintained by <a href="https://github.com/mysql-time-machine">mysql-time-machine</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
